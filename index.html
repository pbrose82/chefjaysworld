<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Chefjaysworld | Blackstone Griddles &amp; Kitchen Stories</title>
<script src="https://cdn.tailwindcss.com"></script>
<script defer="" src="https://cdnjs.cloudflare.com/ajax/libs/alpinejs/3.10.3/cdn.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>
<style>
    [x-cloak] { display: none !important; }
    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    .card-hover {
        transition: all 0.3s ease;
    }
    .card-hover:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(0,0,0,0.1);
    }
    .fade-in {
        animation: fadeIn 0.6s ease-in;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(20px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .tab-active {
        border-bottom: 3px solid #ff6a00;
        color: #ff6a00;
    }
    .logo-img {
        width: 40px;
        height: 40px;
        object-fit: cover;
        border-radius: 50%;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .toast {
        animation: slideIn 0.3s ease-out, fadeOut 0.5s ease-in 3s forwards;
    }
    @keyframes slideIn {
        from { transform: translateX(100%); }
        to { transform: translateX(0); }
    }
    @keyframes fadeOut {
        from { opacity: 1; }
        to { opacity: 0; transform: translateX(100%); }
    }
</style>
</head>
<body class="bg-gray-50">
<div id="app" x-data="appData()" x-init="init()">
<div class="fixed top-4 right-4 z-[100] w-full max-w-xs space-y-3">
    <template :key="toast.id" x-for="toast in toasts">
        <div @click="removeToast(toast.id)" class="toast relative w-full p-4 rounded-lg shadow-lg cursor-pointer" :class="{ 'bg-green-500 text-white': toast.type === 'success', 'bg-red-500 text-white': toast.type === 'error', 'bg-blue-500 text-white': toast.type === 'info' }">
            <p x-text="toast.message"></p>
        </div>
    </template>
</div>
<div class="fixed inset-0 bg-white z-50 flex items-center justify-center" x-cloak="" x-show="loading">
<div class="text-center">
<div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"></div>
<p class="mt-4 text-gray-600">Loading Chef Jay's World...</p>
</div>
</div>
<div class="fixed inset-0 z-50 overflow-y-auto" x-cloak="" x-show="showLoginModal">
<div class="flex items-center justify-center min-h-screen px-4">
<div @click="showLoginModal = false" class="fixed inset-0 bg-black opacity-50"></div>
<div class="relative bg-white rounded-lg max-w-md w-full p-6 shadow-xl">
<h2 class="text-2xl font-bold mb-4">Admin Login</h2>
<div class="bg-red-50 border border-red-200 text-red-600 p-3 rounded mb-4 text-sm" x-show="loginError">
<span x-text="loginError"></span>
</div>
<form @submit.prevent="login()">
<input class="w-full p-3 mb-4 border rounded-lg" placeholder="Email" required="" type="email" x-model="loginEmail"/>
<input class="w-full p-3 mb-4 border rounded-lg" placeholder="Password" required="" type="password" x-model="loginPassword"/>
<div class="flex justify-between">
<button class="bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600" type="submit">Login</button>
<button @click="showLoginModal = false; loginError = ''" class="text-gray-500 hover:text-gray-700" type="button">Cancel</button>
</div>
</form>
</div>
</div>
</div>
<div class="fixed inset-0 z-50 overflow-y-auto" x-cloak="" x-show="showEditModal">
<div class="flex items-center justify-center min-h-screen px-4">
<div @click="showEditModal = false" class="fixed inset-0 bg-black opacity-50"></div>
<div class="relative bg-white rounded-lg max-w-2xl w-full p-6 shadow-xl max-h-[90vh] overflow-y-auto">
<h2 class="text-2xl font-bold mb-4">Edit Product</h2>
<form @submit.prevent="updateProduct()">
<div class="grid md:grid-cols-2 gap-4">
<div>
<label class="block text-sm font-medium text-gray-700 mb-1">Product Name</label>
<input class="w-full p-3 border rounded-lg" required="" type="text" x-model="editingProduct.name"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
<select class="w-full p-3 border rounded-lg" required="" x-model="editingProduct.category">
<option value="blackstone">Blackstone Products</option>
<option value="clothing">Chef Clothing</option>
</select>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1">Price (Optional)</label>
<input class="w-full p-3 border rounded-lg" placeholder="99.99" type="text" x-model="editingProduct.price"/>
</div>
<div>
<label class="block text-sm font-medium text-gray-700 mb-1">Affiliate Link</label>
<input class="w-full p-3 border rounded-lg" placeholder="https://blackstone.com/product?ref=chefjay10" type="url" x-model="editingProduct.affiliateLink"/>
<p class="text-xs text-gray-500 mt-1">Make sure your affiliate code is included in the URL</p>
</div>
<div class="md:col-span-2">
<label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
<textarea class="w-full p-3 border rounded-lg" required="" rows="3" x-model="editingProduct.description"></textarea>
</div>
<div class="md:col-span-2">
<label class="block text-sm font-medium text-gray-700 mb-1">Product Image</label>
<div class="flex items-center space-x-4">
<img :src="editingProduct.image || 'https://placehold.co/100x100'" class="w-20 h-20 object-cover rounded"/>
<input @change="handleEditProductImage($event)" accept="image/*" class="flex-1 p-3 border rounded-lg" type="file"/>
</div>
<p class="text-sm text-blue-600 mt-2" x-show="uploadingImage">Uploading image...</p>
</div>
</div>
<div class="flex justify-end space-x-4 mt-6">
<button @click="showEditModal = false; editingProduct = {}" class="px-6 py-2 text-gray-600 hover:text-gray-800" type="button">Cancel</button>
<button :disabled="uploadingImage" class="bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600 disabled:opacity-50" type="submit">Save Changes</button>
</div>
</form>
</div>
</div>
</div>
<div class="fixed inset-0 z-50 overflow-y-auto bg-gray-100" x-cloak="" x-show="isAdmin &amp;&amp; showAdminPanel">
<div class="min-h-screen">
<div class="bg-white shadow-sm border-b">
<div class="max-w-7xl mx-auto px-4 py-4">
<div class="flex justify-between items-center">
<h1 class="text-2xl font-bold text-gray-800">Admin Dashboard</h1>
<div class="flex items-center space-x-4">
<span class="text-sm text-gray-600">Logged in as: <span class="font-medium" x-text="currentUser?.email"></span></span>
<button @click="showAdminPanel = false" class="text-gray-500 hover:text-gray-700">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
</div>
</div>
</div>
<div class="bg-white border-b">
<div class="max-w-7xl mx-auto px-4">
<div class="flex space-x-8">
<button :class="adminTab === 'dashboard' ? 'tab-active' : ''" @click="adminTab = 'dashboard'" class="py-4 px-2 font-medium transition">Dashboard</button>
<button :class="adminTab === 'products' ? 'tab-active' : ''" @click="adminTab = 'products'" class="py-4 px-2 font-medium transition">Products</button>
<button :class="adminTab === 'stories' ? 'tab-active' : ''" @click="adminTab = 'stories'" class="py-4 px-2 font-medium transition">Stories</button>
<button :class="adminTab === 'about' ? 'tab-active' : ''" @click="adminTab = 'about'" class="py-4 px-2 font-medium transition">About Section</button>
<button :class="adminTab === 'settings' ? 'tab-active' : ''" @click="adminTab = 'settings'" class="py-4 px-2 font-medium transition">Settings</button>
</div>
</div>
</div>
<div class="max-w-7xl mx-auto px-4 py-8">
<div class="space-y-6" x-show="adminTab === 'dashboard'">
<div class="grid md:grid-cols-4 gap-6">
<div class="bg-white p-6 rounded-lg shadow">
<h3 class="text-sm font-medium text-gray-500">Total Products</h3>
<p class="text-3xl font-bold text-gray-800 mt-2" x-text="products.length"></p>
</div>
<div class="bg-white p-6 rounded-lg shadow">
<h3 class="text-sm font-medium text-gray-500">Published Stories</h3>
<p class="text-3xl font-bold text-gray-800 mt-2" x-text="stories.length"></p>
</div>
<div class="bg-white p-6 rounded-lg shadow">
<h3 class="text-sm font-medium text-gray-500">Pending Stories</h3>
<p class="text-3xl font-bold text-orange-600 mt-2" x-text="pendingStories.length"></p>
</div>
<div class="bg-white p-6 rounded-lg shadow">
<h3 class="text-sm font-medium text-gray-500">Featured Stories</h3>
<p class="text-3xl font-bold text-green-600 mt-2" x-text="stories.filter(s => s.featured).length"></p>
</div>
</div>
</div>
<div x-show="adminTab === 'products'">
<div class="bg-white rounded-lg shadow p-6 mb-6">
<h2 class="text-xl font-bold mb-4">Add New Product</h2>
<form @submit.prevent="addProduct()" class="grid md:grid-cols-2 gap-4">
<input class="p-3 border rounded-lg" placeholder="Product Name" required="" type="text" x-model="newProduct.name"/>
<select class="p-3 border rounded-lg" required="" x-model="newProduct.category">
<option value="">Select Category</option>
<option value="blackstone">Blackstone Products</option>
<option value="clothing">Chef Clothing</option>
</select>
<input class="p-3 border rounded-lg" placeholder="Price - Optional (e.g., 99.99)" type="text" x-model="newProduct.price"/>
<input class="p-3 border rounded-lg" placeholder="https://blackstone.com/product?ref=chefjay10" type="url" x-model="newProduct.affiliateLink"/>
<textarea class="p-3 border rounded-lg md:col-span-2" placeholder="Product Description" required="" rows="3" x-model="newProduct.description"></textarea>
<input @change="handleProductImage($event)" accept="image/*" class="p-3 border rounded-lg" type="file"/>
<button :disabled="uploadingImage" class="bg-orange-500 text-white p-3 rounded-lg hover:bg-orange-600 disabled:opacity-50" type="submit">Add Product</button>
</form>
</div>
<div class="bg-white rounded-lg shadow p-6">
<h2 class="text-xl font-bold mb-4">Manage Products</h2>
<div class="overflow-x-auto">
<table class="w-full">
<thead>
<tr class="border-b">
<th class="text-left py-3">Product</th>
<th class="text-left py-3">Category</th>
<th class="text-left py-3">Price</th>
<th class="text-left py-3">Affiliate Link</th>
<th class="text-right py-3">Actions</th>
</tr>
</thead>
<tbody>
<template :key="product.id" x-for="product in products">
<tr class="border-b hover:bg-gray-50">
<td class="py-3">
<div class="flex items-center">
<img :src="product.image || 'https://placehold.co/50x50'" class="w-10 h-10 rounded mr-3 object-cover"/>
<span x-text="product.name"></span>
</div>
</td>
<td class="py-3" x-text="product.category"></td>
<td class="py-3">
<span x-show="product.price" x-text="'$' + product.price"></span>
<span class="text-gray-400" x-show="!product.price">-</span>
</td>
<td class="py-3">
<a :href="product.affiliateLink" class="text-blue-600 hover:text-blue-800 text-sm" target="_blank" x-show="product.affiliateLink">View Link →</a>
<span class="text-red-500 text-sm font-semibold" x-show="!product.affiliateLink &amp;&amp; product.category === 'blackstone'">⚠️ Missing link</span>
<span class="text-gray-400 text-sm" x-show="!product.affiliateLink &amp;&amp; product.category !== 'blackstone'">N/A</span>
</td>
<td class="py-3 text-right space-x-2">
<button @click="editProduct(product)" class="text-blue-600 hover:text-blue-800">Edit</button>
<button @click="deleteProduct(product.id)" class="text-red-600 hover:text-red-800">Delete</button>
</td>
</tr>
</template>
</tbody>
</table>
</div>
</div>
</div>
<div x-show="adminTab === 'stories'">
<div class="bg-white rounded-lg shadow p-6 mb-6">
<h2 class="text-xl font-bold mb-4">Pending Stories</h2>
<div class="space-y-4">
<template :key="story.id" x-for="story in pendingStories">
<div class="border rounded-lg p-4 hover:bg-gray-50">
<div class="flex justify-between items-start">
<div class="flex-1 flex items-start gap-4">
    <img :src="story.imageUrl || 'https://placehold.co/100x100/eeeeee/cccccc?text=Story'" class="w-20 h-20 object-cover rounded-lg flex-shrink-0" alt="Story image" x-show="story.imageUrl">
    <div class="flex-grow">
        <h3 class="font-bold" x-text="story.name"></h3>
        <p class="text-sm text-gray-600" x-text="story.type + ' • ' + story.email"></p>
        <p class="mt-2" x-text="story.story"></p>
    </div>
</div>
<div class="flex space-x-2 ml-4">
<button @click="approveStory(story)" class="bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600">Approve</button>
<button @click="rejectStory(story.id)" class="bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600">Reject</button>
</div>
</div>
</div>
</template>
<p class="text-gray-500 text-center py-8" x-show="pendingStories.length === 0">No pending stories</p>
</div>
</div>
<div class="bg-white rounded-lg shadow p-6">
<h2 class="text-xl font-bold mb-4">Published Stories</h2>
<div class="space-y-4">
<template :key="story.id" x-for="story in stories">
<div :class="story.featured ? 'border-orange-500 bg-orange-50' : ''" class="border rounded-lg p-4 hover:bg-gray-50">
<div class="flex justify-between items-start">
<div class="flex-1 flex items-start gap-4">
    <img :src="story.imageUrl || 'https://placehold.co/100x100/eeeeee/cccccc?text=Story'" class="w-20 h-20 object-cover rounded-lg flex-shrink-0" alt="Story image" x-show="story.imageUrl">
    <div class="flex-grow">
        <div class="flex items-center gap-2">
            <h3 class="font-bold" x-text="story.name"></h3>
            <span class="bg-orange-500 text-white text-xs px-2 py-1 rounded" x-show="story.featured">Featured</span>
        </div>
        <p class="text-sm text-gray-600" x-text="story.type + ' • ' + formatDate(story.timestamp)"></p>
        <p class="mt-2" x-text="story.story"></p>
    </div>
</div>
<div class="flex space-x-2 ml-4">
<button @click="toggleFeatured(story)" class="text-orange-600 hover:text-orange-800 text-sm" x-text="story.featured ? 'Unfeature' : 'Feature'"></button>
<button @click="deleteStory(story.id)" class="text-red-600 hover:text-red-800 text-sm">Delete</button>
</div>
</div>
</div>
</template>
</div>
</div>
</div>
<div class="bg-white rounded-lg shadow p-6" x-show="adminTab === 'about'">
    <h2 class="text-xl font-bold mb-4">Edit About Section</h2>
    <form @submit.prevent="saveSettings()">
        <div class="space-y-4">
            <div>
                <label for="aboutText" class="block text-sm font-medium text-gray-700 mb-2">About Content</label>
                <p class="text-xs text-gray-500 mb-2">This content will be displayed in the "About" section of your homepage. Write a short bio or a welcome message.</p>
                <textarea id="aboutText" class="w-full p-3 border rounded-lg" rows="8" x-model="settings.aboutText"></textarea>
            </div>
            <button class="bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600" type="submit">Save Changes</button>
        </div>
    </form>
</div>
<div class="bg-white rounded-lg shadow p-6" x-show="adminTab === 'settings'">
    <h2 class="text-xl font-bold mb-4">Site Settings</h2>
    
    <div class="space-y-4 mb-8 pb-8 border-b">
        <h3 class="font-semibold text-lg">Homepage Background Image</h3>
         <div>
            <label for="heroImage" class="block text-sm font-medium text-gray-700 mb-2">Upload New Background</label>
            <p class="text-xs text-gray-500 mb-2">This will replace the main background image on the homepage.</p>
            <div class="flex items-center gap-4">
                 <img :src="settings.heroImageUrl || 'https://placehold.co/200x100/eeeeee/cccccc?text=No+Image'" class="w-48 h-auto rounded object-cover shadow">
                 <input type="file" id="heroImage" @change="handleHeroImageUpload($event)" accept="image/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-orange-50 file:text-orange-700 hover:file:bg-orange-100">
            </div>
            <p x-show="uploadingHeroImage" class="text-blue-600 text-sm mt-2">Uploading...</p>
        </div>
    </div>

    <form @submit.prevent="saveSettings()">
        <div class="space-y-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Blackstone Affiliate Code</label>
                <input class="w-full p-3 border rounded-lg" placeholder="your-affiliate-code" type="text" x-model="settings.affiliateCode"/>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Site Title</label>
                <input class="w-full p-3 border rounded-lg" placeholder="Chefjaysworld" type="text" x-model="settings.siteTitle"/>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Welcome Message</label>
                <textarea class="w-full p-3 border rounded-lg" rows="3" x-model="settings.welcomeMessage"></textarea>
            </div>
            <button class="bg-orange-500 text-white px-6 py-2 rounded-lg hover:bg-orange-600" type="submit">Save Text Settings</button>
        </div>
    </form>
    <div class="mt-8 pt-8 border-t">
        <h3 class="font-semibold mb-4">Account Management</h3>
        <button @click="logout()" class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600">Logout</button>
    </div>
</div>
</div>
</div>
</div>
<nav class="bg-white shadow-md sticky top-0 z-40">
<div class="max-w-7xl mx-auto px-4">
<div class="flex justify-between items-center h-16">
<div class="flex items-center">
<img alt="Chef Jay" class="logo-img" src="jay.jpeg"/>
<span class="text-xl font-bold text-orange-600 ml-3">Chefjaysworld</span>
</div>
<div class="hidden md:flex items-center space-x-8">
<a class="text-gray-700 hover:text-orange-600 transition" href="#home">Home</a>
<a class="text-gray-700 hover:text-orange-600 transition" href="#blackstone">Blackstone</a>
<a class="text-gray-700 hover:text-orange-600 transition" href="#clothing">Clothing</a>
<a class="text-gray-700 hover:text-orange-600 transition" href="#stories">Stories</a>
<a class="text-gray-700 hover:text-orange-600 transition" href="#about">About</a>
<button @click="isAdmin ? showAdminPanel = true : showLoginModal = true" class="text-gray-700 hover:text-orange-600 transition">
<svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<button class="md:hidden">
<svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24">
<path d="M4 6h16M4 12h16M4 18h16" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
</div>
</nav>
<header class="text-white relative" id="home" :style="'background: url(\'' + (settings.heroImageUrl || 'kitchen-background.jpg') + '\') center/cover;'">
    <div class="absolute inset-0 bg-black opacity-60"></div>
    <div class="relative max-w-7xl mx-auto px-4 py-20 text-center">
        <h1 class="text-4xl md:text-5xl font-bold mb-4 fade-in" x-text="settings.siteTitle || 'Welcome to Chef Jay\'s Kitchen World'"></h1>
        <p class="text-xl mb-8 max-w-2xl mx-auto fade-in" x-text="settings.welcomeMessage || 'Discover premium Blackstone griddles, professional chef apparel, and share your kitchen stories with our community'"></p>
        <div class="flex flex-wrap justify-center gap-4 fade-in">
            <a class="bg-black text-white px-8 py-3 rounded-full font-bold hover:bg-gray-800 transition transform hover:scale-105" href="#blackstone">Shop Blackstone</a>
            <a class="bg-white text-orange-600 px-8 py-3 rounded-full font-bold hover:bg-orange-100 transition transform hover:scale-105" href="#stories">Share Your Story</a>
        </div>
    </div>
</header>
<section class="py-16 bg-gray-900 text-white relative bg-cover bg-center" id="blackstone" style="background-image: url('https://images.unsplash.com/photo-1601315576604-2f9b54d16f5c?auto=format&amp;fit=crop&amp;w=1470&amp;q=80');">
<div class="max-w-7xl mx-auto px-4">
<h2 class="text-3xl font-bold text-center mb-4">Blackstone Products</h2>
<p class="text-center text-gray-300 mb-8 max-w-3xl mx-auto">Get exclusive 10% off on all Blackstone products through our affiliate links!</p>
<div class="grid md:grid-cols-3 gap-8">
<template :key="product.id" x-for="product in products.filter(p => p.category === 'blackstone')">
<div class="bg-gray-800 rounded-lg overflow-hidden card-hover">
<img :alt="product.name" :src="product.image || 'https://placehold.co/400x300'" class="w-full h-48 object-cover"/>
<div class="p-6">
<h3 class="text-xl font-bold mb-2" x-text="product.name"></h3>
<p class="text-gray-400 mb-4" x-text="product.description"></p>
<div class="flex justify-between items-center">
<span class="text-2xl font-bold text-yellow-400" x-show="product.price" x-text="'$' + product.price"></span>
<span class="text-gray-500" x-show="!product.price">Contact for price</span>
<a :href="product.affiliateLink || '#'" class="bg-yellow-400 text-black px-6 py-2 rounded-full hover:bg-yellow-300 transition font-bold" target="_blank">Shop Now →</a>
</div>
</div>
</div>
</template>
</div>
</div>
</section>
<section class="py-16 bg-white" id="clothing">
<div class="max-w-7xl mx-auto px-4">
<h2 class="text-3xl font-bold text-center mb-4">Professional Chef Clothing</h2>
<p class="text-center text-gray-600 mb-12 max-w-3xl mx-auto">High-quality apparel designed for comfort and durability in the kitchen</p>
<div class="grid md:grid-cols-3 gap-8">
<template :key="product.id" x-for="product in products.filter(p => p.category === 'clothing')">
<div class="bg-white rounded-lg shadow-lg overflow-hidden card-hover border">
<img :alt="product.name" :src="product.image || 'https://placehold.co/400x300'" class="w-full h-48 object-cover"/>
<div class="p-6">
<h3 class="text-xl font-bold mb-2" x-text="product.name"></h3>
<p class="text-gray-600 mb-4" x-text="product.description"></p>
<div class="flex justify-between items-center">
<span class="text-2xl font-bold text-orange-600" x-show="product.price" x-text="'$' + product.price"></span>
<span class="text-gray-500" x-show="!product.price">Contact for price</span>
<button class="bg-orange-500 text-white px-6 py-2 rounded-full hover:bg-orange-600 transition font-bold">Shop Now</button>
</div>
</div>
</div>
</template>
</div>
</div>
</section>
<section class="py-16 bg-orange-50" id="stories">
<div class="max-w-7xl mx-auto px-4">
<h2 class="text-3xl font-bold text-center mb-12">Share Your Kitchen Story</h2>
<div class="grid md:grid-cols-2 gap-8">
<div class="bg-white rounded-lg shadow-lg p-6">
    <h3 class="text-2xl font-bold mb-6">Latest Stories</h3>
    <div class="space-y-4 max-h-[600px] overflow-y-auto pr-4">
        <template :key="story.id" x-for="story in stories">
            <div class="border-b pb-4">
                <div class="flex items-start gap-4">
                    <img :src="story.imageUrl || 'https://placehold.co/100x100/eeeeee/cccccc?text=Story'" class="w-24 h-24 object-cover rounded-lg flex-shrink-0" alt="Story image" x-show="story.imageUrl">
                    <div class="flex-grow">
                        <h5 class="font-bold" x-text="story.name"></h5>
                        <p class="text-sm text-orange-600 mb-2" x-text="story.type"></p>
                        <p class="text-gray-600" x-text="story.story"></p>
                    </div>
                </div>
                <div class="flex justify-between items-center mt-3">
                    <p class="text-xs text-gray-400" x-text="formatDate(story.timestamp)"></p>
                    <div class="flex items-center gap-3">
                        <button @click="voteOnStory(story, 'up')" class="text-gray-400 hover:text-green-500" :class="{ 'text-green-500 font-bold': hasVoted(story.id) }">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 01.707.293l5 5a1 1 0 01-1.414 1.414L11 5.414V16a1 1 0 11-2 0V5.414L5.707 8.707a1 1 0 01-1.414-1.414l5-5A1 1 0 0110 2z"></path></svg>
                        </button>
                        <span class="text-lg font-semibold text-gray-700" x-text="story.votes || 0"></span>
                    </div>
                </div>
            </div>
        </template>
        <p class="text-gray-500" x-show="stories.length === 0">No stories yet. Be the first to share!</p>
    </div>
</div>
<div class="bg-white rounded-lg shadow-lg p-6">
    <h3 class="text-2xl font-bold mb-6">Submit Your Story</h3>
    <form @submit.prevent="submitStory()">
        <input class="w-full p-3 mb-4 border rounded-lg" placeholder="Your Name" required="" type="text" x-model="storyForm.name"/>
        <input class="w-full p-3 mb-4 border rounded-lg" placeholder="Your Email" required="" type="email" x-model="storyForm.email"/>
        <select class="w-full p-3 mb-4 border rounded-lg" required="" x-model="storyForm.type">
            <option value="">Select Type</option>
            <option value="Burn of the Day">Burn of the Day</option>
            <option value="Food Concept">Food Concept</option>
            <option value="Kitchen Story">Kitchen Story</option>
            <option value="Question">Question for Chef Jay</option>
        </select>
        <textarea class="w-full p-3 mb-4 border rounded-lg" placeholder="Share your experience..." required="" rows="6" x-model="storyForm.story"></textarea>
        <label class="block text-sm font-medium text-gray-700 mb-2">Add an Image (Optional)</label>
        <div class="border rounded-lg p-3">
            <input @change="handleStoryImage($event)" accept="image/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-orange-50 file:text-orange-700 hover:file:bg-orange-100" type="file"/>
            <img x-show="storyForm.imageUrl" :src="storyForm.imageUrl" class="mt-4 rounded-lg w-32 h-32 object-cover" alt="Image preview">
        </div>
        <button :disabled="isSubmittingStory" class="w-full bg-orange-500 text-white py-3 mt-4 rounded-lg hover:bg-orange-600 transition font-bold disabled:opacity-50 flex items-center justify-center" type="submit">
            <svg x-show="isSubmittingStory" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span x-text="isSubmittingStory ? 'Submitting...' : 'Submit Story'"></span>
        </button>
    </form>
</div>
</div>
</div>
</section>
<section class="py-16 bg-white" id="about">
    <div class="max-w-7xl mx-auto px-4">
        <div class="grid md:grid-cols-2 gap-12 items-center">
            <div class="text-left">
                <h2 class="text-3xl font-bold mb-4">About Chef Jay</h2>
                <p class="text-gray-600 leading-relaxed whitespace-pre-line" x-text="settings.aboutText"></p>
            </div>
            <div class="flex justify-center">
                <img src="jay.jpeg" alt="Chef Jay smiling" class="rounded-lg shadow-2xl w-full max-w-sm h-auto object-cover">
            </div>
        </div>
    </div>
</section>
<footer class="bg-gray-800 text-white py-12">
<div class="max-w-7xl mx-auto px-4 text-center">
<p class="mb-2">© 2025 Chefjaysworld. All rights reserved.</p>
<p class="text-sm text-gray-400">All Blackstone links include automatic 10% discount for our community.</p>
</div>
</footer>
</div>
<script>
    const firebaseConfig = {
        apiKey: "AIzaSyACwcytRMry8xYii-Do4uErlli7CT6qMb0",
        authDomain: "chefjaysworld.firebaseapp.com",
        projectId: "chefjaysworld",
        storageBucket: "chefjaysworld.appspot.com",
        messagingSenderId: "156166389859",
        appId: "1:156166389859:web:c098e5804bef1c3601f856",
        measurementId: "G-BSEFPYMZD7"
    };
    
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();
    const storage = firebase.storage();
    
    function appData() {
        return {
            // UI States
            loading: true,
            showLoginModal: false,
            showAdminPanel: false,
            showEditModal: false,
            isAdmin: false,
            adminTab: 'dashboard',
            storySubmitted: false,
            uploadingImage: false,
            loginError: '',
            currentUser: null,
            isSubmittingStory: false,
            uploadingHeroImage: false,
            toasts: [],
            
            // Data
            products: [],
            stories: [],
            pendingStories: [],
            votedStoryIds: [],
            
            // Forms
            loginEmail: '',
            loginPassword: '',
            newProduct: { name: '', category: '', price: '', description: '', affiliateLink: '', image: null, imageFile: null },
            editingProduct: {},
            storyForm: { name: '', email: '', type: '', story: '', imageFile: null, imageUrl: '' },
            settings: {
                affiliateCode: 'chefjay10',
                siteTitle: 'Welcome to Chef Jay\'s Kitchen World',
                welcomeMessage: 'Discover premium Blackstone griddles, professional chef apparel, and share your kitchen stories with our community',
                aboutText: 'This is the default about text. You can edit this in the new "About Section" tab in the admin panel.',
                heroImageUrl: ''
            },

            async init() {
                try {
                    this.loadVotedStories();
                    auth.onAuthStateChanged(async (user) => {
                        this.isAdmin = !!user;
                        this.currentUser = user;
                    });
                    
                    await this.loadProducts();
                    await this.loadStories();
                    await this.loadSettings();
                    
                } catch (error) {
                    this.showToast('Could not load site data.', 'error');
                } finally {
                    this.loading = false;
                }
            },

            async login() {
                this.loginError = '';
                try {
                    const result = await auth.signInWithEmailAndPassword(this.loginEmail, this.loginPassword);
                    this.isAdmin = true;
                    this.currentUser = result.user;
                    this.showLoginModal = false;
                    this.showAdminPanel = true;
                    this.loginEmail = '';
                    this.loginPassword = '';
                    this.showToast('Logged in successfully!');
                } catch (error) {
                    if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password' || error.code === 'auth/invalid-credential') {
                        this.loginError = 'Invalid credentials. Please try again.';
                    } else {
                        this.loginError = 'An unexpected error occurred.';
                    }
                }
            },

            async logout() {
                try {
                    await auth.signOut();
                    this.isAdmin = false;
                    this.currentUser = null;
                    this.showAdminPanel = false;
                    this.showToast('You have been logged out.');
                } catch (error) {
                    this.showToast('Logout failed.', 'error');
                }
            },

            async loadProducts() {
                try {
                    const snapshot = await db.collection('products').orderBy('timestamp', 'desc').get();
                    this.products = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                } catch (error) {
                    console.error('Error loading products:', error);
                }
            },

            async loadStories() {
                try {
                    const approvedSnapshot = await db.collection('stories')
                        .where('status', '==', 'approved')
                        .orderBy('votes', 'desc')
                        .orderBy('timestamp', 'desc')
                        .get();
                    this.stories = approvedSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    
                    const pendingSnapshot = await db.collection('stories')
                        .where('status', '==', 'pending')
                        .orderBy('timestamp', 'desc')
                        .get();
                    this.pendingStories = pendingSnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                } catch (error) {
                    console.error('Error loading stories:', error);
                }
            },
            
            async loadSettings() {
                try {
                    const doc = await db.collection('settings').doc('main').get();
                    if (doc.exists) {
                        this.settings = { ...this.settings, ...doc.data() };
                    }
                } catch (error) {
                    console.error('Error loading settings:', error);
                }
            },

            async saveSettings() {
                try {
                    await db.collection('settings').doc('main').set(this.settings, { merge: true });
                    this.showToast('Settings saved!', 'success');
                } catch (error) {
                    this.showToast('Failed to save settings.', 'error');
                }
            },

            async handleHeroImageUpload(event) {
                const file = event.target.files[0];
                if (!file) return;

                this.uploadingHeroImage = true;

                try {
                    const storageRef = storage.ref('settings/heroImage');
                    const snapshot = await storageRef.put(file);
                    const url = await snapshot.ref.getDownloadURL();

                    this.settings.heroImageUrl = url;
                    await this.saveSettings();
                    
                    this.showToast('Homepage image updated!', 'success');
                } catch (error) {
                    console.error("Error uploading hero image:", error);
                    this.showToast('Image upload failed.', 'error');
                } finally {
                    this.uploadingHeroImage = false;
                }
            },
            
            async addProduct() {
                try {
                    this.uploadingImage = true;
                    let imageUrl = null;
                    if (this.newProduct.imageFile) {
                        const filename = `products/${Date.now()}_${this.newProduct.imageFile.name}`;
                        const storageRef = storage.ref(filename);
                        const snapshot = await storageRef.put(this.newProduct.imageFile);
                        imageUrl = await snapshot.ref.getDownloadURL();
                    }
                    const product = { name: this.newProduct.name, category: this.newProduct.category, price: this.newProduct.price || '', description: this.newProduct.description, affiliateLink: this.newProduct.affiliateLink || '', image: imageUrl, timestamp: firebase.firestore.FieldValue.serverTimestamp() };
                    const docRef = await db.collection('products').add(product);
                    this.products.unshift({ id: docRef.id, ...product, timestamp: new Date() });
                    this.newProduct = { name: '', category: '', price: '', description: '', affiliateLink: '', image: null, imageFile: null };
                    this.showToast('Product added successfully!');
                } catch (error) {
                    this.showToast('Failed to add product: ' + error.message, 'error');
                } finally {
                    this.uploadingImage = false;
                }
            },

            editProduct(product) {
                this.editingProduct = { ...product };
                this.showEditModal = true;
            },

            async updateProduct() {
                try {
                    this.uploadingImage = true;
                    let imageUrl = this.editingProduct.image;
                    if (this.editingProduct.imageFile) {
                        const filename = `products/${Date.now()}_${this.editingProduct.imageFile.name}`;
                        const storageRef = storage.ref(filename);
                        const snapshot = await storageRef.put(this.editingProduct.imageFile);
                        imageUrl = await snapshot.ref.getDownloadURL();
                    }
                    const updates = { name: this.editingProduct.name, category: this.editingProduct.category, price: this.editingProduct.price || '', description: this.editingProduct.description, affiliateLink: this.editingProduct.affiliateLink || '', image: imageUrl, updatedAt: firebase.firestore.FieldValue.serverTimestamp() };
                    await db.collection('products').doc(this.editingProduct.id).update(updates);
                    const index = this.products.findIndex(p => p.id === this.editingProduct.id);
                    if (index !== -1) {
                        this.products[index] = { ...this.products[index], ...updates };
                    }
                    this.showEditModal = false;
                    this.editingProduct = {};
                    this.showToast('Product updated successfully!');
                } catch (error) {
                    this.showToast('Failed to update product: ' + error.message, 'error');
                } finally {
                    this.uploadingImage = false;
                }
            },

            handleProductImage(event) {
                const file = event.target.files[0];
                if (file) {
                    this.newProduct.imageFile = file;
                    this.newProduct.image = URL.createObjectURL(file);
                }
            },

            handleEditProductImage(event) {
                const file = event.target.files[0];
                if (file) {
                    this.editingProduct.imageFile = file;
                    this.editingProduct.image = URL.createObjectURL(file);
                }
            },

            async deleteProduct(productId) {
                if (confirm('Are you sure you want to delete this product?')) {
                    try {
                        await db.collection('products').doc(productId).delete();
                        this.products = this.products.filter(p => p.id !== productId);
                        this.showToast('Product deleted');
                    } catch (error) {
                        this.showToast('Failed to delete product: ' + error.message, 'error');
                    }
                }
            },

            async submitStory() {
                if (this.isSubmittingStory) return;
                this.isSubmittingStory = true;
                try {
                    let storyImageUrl = '';
                    if (this.storyForm.imageFile) {
                        const file = this.storyForm.imageFile;
                        const filename = `stories/${Date.now()}_${file.name}`;
                        const storageRef = storage.ref(filename);
                        const snapshot = await storageRef.put(file);
                        storyImageUrl = await snapshot.ref.getDownloadURL();
                    }
                    const story = { name: this.storyForm.name, email: this.storyForm.email, type: this.storyForm.type, story: this.storyForm.story, imageUrl: storyImageUrl, status: 'pending', featured: false, votes: 0, timestamp: firebase.firestore.FieldValue.serverTimestamp() };
                    await db.collection('stories').add(story);
                    this.storyForm = { name: '', email: '', type: '', story: '', imageFile: null, imageUrl: '' };
                    this.showToast('Story submitted for review!', 'success');
                } catch (error) {
                    this.showToast('Failed to submit story.', 'error');
                } finally {
                    this.isSubmittingStory = false;
                }
            },

            handleStoryImage(event) {
                const file = event.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) {
                        this.showToast('Image file is too large (max 5MB).', 'error');
                        return;
                    }
                    this.storyForm.imageFile = file;
                    this.storyForm.imageUrl = URL.createObjectURL(file);
                }
            },
            
            async approveStory(story) {
                try {
                    await db.collection('stories').doc(story.id).update({ status: 'approved', approvedAt: firebase.firestore.FieldValue.serverTimestamp() });
                    story.status = 'approved';
                    this.stories.unshift(story);
                    this.pendingStories = this.pendingStories.filter(s => s.id !== story.id);
                    this.showToast('Story approved!');
                } catch (error) {
                    this.showToast('Failed to approve story: ' + error.message, 'error');
                }
            },

            async rejectStory(storyId) {
                try {
                    await db.collection('stories').doc(storyId).delete();
                    this.pendingStories = this.pendingStories.filter(s => s.id !== storyId);
                    this.showToast('Story rejected');
                } catch (error) {
                    this.showToast('Failed to reject story: ' + error.message, 'error');
                }
            },

            async deleteStory(storyId) {
                if (confirm('Are you sure you want to delete this story?')) {
                    try {
                        await db.collection('stories').doc(storyId).delete();
                        this.stories = this.stories.filter(s => s.id !== storyId);
                        this.showToast('Story deleted');
                    } catch (error) {
                        this.showToast('Failed to delete story: ' + error.message, 'error');
                    }
                }
            },

            async toggleFeatured(story) {
                try {
                    const newFeaturedStatus = !story.featured;
                    await db.collection('stories').doc(story.id).update({ featured: newFeaturedStatus });
                    story.featured = newFeaturedStatus;
                } catch (error) {
                    this.showToast('Failed to update story: ' + error.message, 'error');
                }
            },

            loadVotedStories() {
                this.votedStoryIds = JSON.parse(localStorage.getItem('voted_stories')) || [];
            },
            
            hasVoted(storyId) {
                return this.votedStoryIds.includes(storyId);
            },
            
            async voteOnStory(story) {
                if (this.hasVoted(story.id)) {
                    this.showToast('You have already voted for this story.', 'info');
                    return;
                }
                try {
                    const storyRef = db.collection('stories').doc(story.id);
                    await db.runTransaction(async (transaction) => {
                        const doc = await transaction.get(storyRef);
if (!doc.exists) throw "Document does not exist!";
                        const newVotes = (doc.data().votes || 0) + 1;
                        transaction.update(storyRef, { votes: newVotes });
                    });
                    const storyIndex = this.stories.findIndex(s => s.id === story.id);
                    if(storyIndex !== -1) {
                        this.stories[storyIndex].votes = (this.stories[storyIndex].votes || 0) + 1;
                    }
                    this.votedStoryIds.push(story.id);
                    localStorage.setItem('voted_stories', JSON.stringify(this.votedStoryIds));
                    this.showToast('Vote counted!', 'success');
                } catch (error) {
                    this.showToast('Could not count your vote.', 'error');
                }
            },

            showToast(message, type = 'success') {
                const id = Date.now();
                this.toasts.push({ id, message, type });
                setTimeout(() => {
                    this.removeToast(id);
                }, 4000);
            },
            
            removeToast(id) {
                this.toasts = this.toasts.filter(toast => toast.id !== id);
            },

            formatDate(timestamp) {
                if (!timestamp) return 'Unknown date';
                const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
                return date.toLocaleDateString();
            }
        }
    }
</script>
</body>
</html>
